# САПР "Пластинка"

![alt](doc/image/example.png)

## О системе

Система может рассчитать пластину на теплопроводность одним из следующих методов:

- МКР с неявной схемой (с матрицей общего вида)
- МКР с неявной схемой и методом расщепления (с трёхдиагональной матрицей)
- МКР с явной схемой

## Описание задачи

Рассчитать пластину на теплопроводность. Заданы граничные условия 1, 2 и 3 рода.

Дифференциальное уравнение:

$$
\frac{\partial T}{\partial t} = \frac{\lambda}{c \rho}\Delta T
$$

## Описание методов решения

### Метод конечных разностей

Пусть дано ДУ в частных производных:

$$
\mathcal{L}T+P=0,
$$

где $\mathcal{L}$ - дифференциальный оператор, $T$ - фазовая переменная, $P$ - свободный член.

Чтобы решить его численными методами, можно заменить дифференциальный оператор его аппроксимацией - разностным аналогом.
Такой метод называется методом конечных разностей.

### Сетка для МКР

Сетка состоит из двух видов узлов:

- Внутренние - у таких узлов по 4 смежных узла;
- Внешние (правые, левые, верхние и нижние) - у таких узлов есть строго один смежный внутренний узел. Такой узел отстоит от смежного на расстояние, в общем случае не равное шагу сетки. Узел принадлежит одной из границ пластины, привязан к граничному условию.

### Разностный аналог второй производной для неравномерной сетки

![](./doc/image/irregular_mesh.svg)

$$
\frac{\partial^2v}{\partial x^2}=2\frac{\mu v_C - (\mu +1)v_B + v_A}{\mu (\mu +1)\Delta x^2}
$$

### Учёт граничных условий

Граничное условие первого рода - просто константная температура, самое простое в учёте.

Граничные условия второго и третьего рода учитываются по-разному в зависимости от метода решения.

### Явный метод Эйлера

![alt](doc/image/explicit_euler.svg)

Каждая итерация явного метода Эйлера представляет собой два шага:

1. Нахождение значений фазовой переменной для внутренних узлов;
2. Нахождение значений фазовой переменной для внешних узлов.

На первом шаге для каждого внутреннего узла определяется его значение на следующем временном слое по формуле:

$$
T_{ij}^{k+1} = T_{ij}^{k} + K\cdot
\left(
K_x \cdot \left(\mu_x T_{i+1,j}^k - (\mu_x+1)T_{ij}^k + T_{i-1,j}^k\right) +
K_y\cdot\left(\mu_y T_{i,j+1}^k - (\mu_y+1)T_{ij}^k + T_{i,j-1}^k\right)
\right)
$$

где $K=\frac{2\lambda \Delta t}{c \rho}$, $K_x=\frac{1}{\mu_x (\mu_x + 1) \Delta x^2}$, $K_y=\frac{1}{\mu_y (\mu_y + 1) \Delta y^2}$.

На втором шаге значения фазовой переменной для внешних узлов определяются через значения внутренних узлов.

### Неявный метод Эйлера - обычный

![](./doc/image/implicit_euler.svg)

Идея метода заключается в том, чтобы записать систему уравений для переменных состояния следующего временного слоя, затем её решить и получить вектор фазовых переменных.

Из-за специфики решаемого ДУ в частных производных получается система линейных алгебраических уравнений.

На каждом шаге сначала происходит запись уравнений для внутренних и внешних узлов, затем происходит решение СЛАУ.

Уравнение для внутренних узлов

$$
T_{ij}^{k+1} = T_{ij}^{k} + K\cdot
\left(
K_x \cdot \left(\mu_x T_{i+1,j}^{k+1} - (\mu_x+1)T_{ij}^{k+1} + T_{i-1,j}^{k+1}\right) +
K_y\cdot\left(\mu_y T_{i,j+1}^{k+1} - (\mu_y+1)T_{ij}^{k+1} + T_{i,j-1}^{k+1}\right)
\right)
$$

Неявный метод Эйлера имеет лучшую вычислительную устойчивость по сравнению с неявным, но требует значительно больше вычислительных ресурсов.

### Неявный метод Эйлера - метод расщепления

![](./doc/image/rassloen_euler.svg)

Из теории математической физики следует, что если сначала решить уравнение вдоль одной оси, а затем - вдоль другой, получится решение с определённой погрешностью.

#### Алгоритм решения

В двумерном случае метод расслоения состоит из двух шагов:

1. Составить уравнения вдоль оси $x$:

$$
V_{ij}^{k+1} = V_{ij}^{k} + K\cdot
\left(
K_x \cdot \left(\mu_x V_{i+1,j}^{k+1} - (\mu_x+1)V_{ij}^{k+1} + V_{i-1,j}^{k+1}\right)
\right)
$$,

где $V_{ij}^k=T_{ij}^k$.

Также должны быть записаны уравнения граничных узлов для левых и правых внешних узлов. Верхние и нижние внешние узлы должны быть проигнорированы.

Значения $V$ для левых и правых внешних узлов сохраняются как значения фазовой переменной в них.

После решения этой СЛАУ получаются значения $V$ для всех внутренних узлов.

2. Составить уравнения вдоль оси $y$:

$$
W_{ij}^{k+1} = W_{ij}^{k} + K\cdot
\left(
K_y\cdot\left(\mu_y W_{i,j+1}^{k+1} - (\mu_y+1)W_{ij}^{k+1} + W_{i,j-1}^{k+1}\right)
\right),
$$

где $W_{ij}^k=V_{ij}^{k+1}$

Также должны быть записаны уравнения граничных узлов для верхних и нижних внешних узлов. Левые и правые внешние узлы должны быть проигнорированы, для них значение фазовой переменной $T_{lm}^{k+1}=W_{lm}^{k+1}$ найдено на предыдущем шаге.

Значения $V_{ij}^{k+1}$ для всех узлов, которые участвовали в уравнениях, сохраняются в решение как $T$.

#### Особенности метода

На каждом шаге получается трёхдиагональная матрица, которую можно решить методом прогонки. При небольшом увеличении погрешности метод даёт серьёзный прирост к производительности: от временной сложности $O(n^3)$ можно перейти к $O(n)$.
